#{extends 'core/layout.html' /}

<div id="coreShow">
	<div class="listSort span-18">
	&{'sparta.users.settings'}
	</div>
    <div class="ui-corner-all">
    <div class="listButtons">
   
    </div>    
    <div id="edit-tabs">
	<ul>
		<li><a href="#account-info">Account</a></li>
		<li><a href="#password">Password</a></li>
		<li><a href="#preferences">Preferences</a></li>
		<li><a href="#profiles">Profile</a></li>		
	</ul>
	<div id="account-info">
	<div id="message_account"></div> 
	   <form id="accountForm">  
          <fieldset>  
           <legend>Account</legend>  
           <p><label for="username_text">Username:</label><br />
           <label for="username_text">${object.username}</label><br /></p>    
           <p><label for="email_text">E-mail:</label><br />
           <input id="email_text" type="text" name="u.email" /></p>
           <p><label for="firstName_text">First Name:</label><br />
           <input id="firstName_text" type="text" name="u.firstName" /></p>
           <p><label for="lastName_text">Last Name:</label><br />
           <input id="lastName_text" type="text" name="u.lastName" /></p>         
           <p><input type="submit" value="Submit" /></p>  
           </fieldset>
       </form>  
       
	</div>
	<div id="password">
	<div id="message_pwd"></div> 
	<form id="passwordForm">  
          <fieldset>  
           <legend>Update Password</legend>                
           <p><label for="currentpassword_text">Current Password:</label><br />
           <input id="currentpassword_text" type="text" name="currentpassword" /></p>
           <p><label for="newpassword_text">New Password:</label><br />
           <input id="newpassword_text" type="text" name="newpassword" /></p>
           <p><label for="verifypassword_text">Verify Password:</label><br />
           <input id="verifypassword_text" type="text" name="verifypassword" /></p>         
           <p><input type="submit" value="Submit" /></p>  
           </fieldset>
       </form>  
	</div>
	<div id="preferences"class="objectForm">
	fffdgfdg
	</div>
	<div id="profiles"class="objectForm">
	fffdgfdg
	</div>
   </div>
   </div>
</div>
<!--  change the buttons to a class -->
<script>
$(function() {
	$( "#edit-tabs" ).tabs();

	    $("#accountForm").submit(function(){
	        $.post("/settings/accountupdate", $("#accountForm").serialize(),
	        function(data){
		        if(data.error){
                     alert("returned error");
			        }
	            if(data.error){

	                    $("#message_account").append("<div class='errorMessage'> " + data.error+ "</div>").show(200);
	            } else {
	                $("#message_account").html("<div class='successMessage'>" + data.email + " is a valid e-mail address. Thank you, " + data.name + ".</div>");
	                }
	        }, "json");

	        return false;

	    });


	    $("#passwordForm").submit(function(){
	        $.post("/settings/pwdupdate", $("#passwordForm").serialize(),
	        function(data){
		        alert(data);
		        if(data.error){
                   alert(data.error);
		        }
	            if(data.email_check == 'invalid'){

	                    $("#message_pwd").html("<div class='errorMessage'>Sorry " + data.name + ", " + data.email + " is NOT a valid e-mail address. Try again.</div>");
	            } else {
	                $("#message_pwd").html("<div class='successMessage'>" + data.email + " is a valid e-mail address. Thank you, " + data.name + ".</div>");
	                }
	        }, "json");

	        return false;

	    });
});
</script>

		
